-- 刪除目標 appid 中 achievements = 0 的資料
DELETE FROM achievement_trend
WHERE appid IN (790820, 824550, 597180, 1336980, 1919460, 1009290, 
                924980, 1502980, 1502990, 740130, 1811950, 2113920, 
				1732390, 2161700, 1113000, 1687950, 1502970, 1621310, 
				1962430, 385800, 333600, 1431570, 1461920, 728530, 8930,
				392110, 208140, 236850, 298050, 466560, 489630, 1843940,
				345350, 1446780, 582010, 952540, 1748660, 1086940, 640820,
				1284190, 403190, 205610, 1318690, 72850, 489830, 368230,
				701160, 219990, 435150, 1621690, 1942280, 617480)
  AND achievements = 0;

-- 回填數值從最早日 ~ 最新日（包含）
WITH RECURSIVE
date_bounds AS (
  SELECT MIN(date) AS start_date, MAX(date) AS end_date
  FROM achievement_trend
),
date_range(date) AS (
  SELECT start_date FROM date_bounds
  UNION ALL
  SELECT DATE(date, '+1 day') FROM date_range, date_bounds
  WHERE date < end_date
),
targets(appid, achievements) AS (
  VALUES
    (790820, 7),
    (824550, 43),
    (597180, 24),
    (1336980, 1),
    (1919460, 8),
    (1009290, 67),
	(924980, 44),
	(1502980, 45),
	(1502990, 50),
	(740130, 58),
	(1811950, 53),
	(2113920, 53),
	(1732390, 19),
	(2161700, 48),
	(1113000, 50),
	(1687950, 53),
	(1502970, 45),
	(1621310, 48),
	(1962430, 4),
	(385800, 3),
	(333600, 6),
	(1431570, 18),
	(1461920, 1),
	(728530, 12),
	(8930, 38),
	(392110, 33),
	(208140, 14),
	(236850, 1),
	(298050, 19),
	(466560, 1),
	(489630, 14),
	(1843940, 35),
	(345350, 2),
	(1446780, 100),
	(582010, 100),
	(952540, 41),
	(1748660, 14),
	(1086940, 11),
	(640820, 6),
	(1284190, 39),
	(403190, 14),
	(205610, 2),
	(1318690, 11),
	(72850, 10),
	(489830, 15),
	(368230, 2),
	(701160, 5),
	(219990, 4),
	(435150, 34),
	(1621690, 32),
	(1942280, 83),
	(617480, 9)
)
INSERT OR REPLACE INTO achievement_trend(date, appid, achievements)
SELECT d.date, t.appid, t.achievements
FROM date_range d
CROSS JOIN targets t;
