<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <title>好友國別分析 - Steam 好友追蹤系統</title>
    <link rel="stylesheet" href="/static/style.css">
</head>
<body>
    <div class="container">
        <h1>Steam 好友追蹤系統 - 國別分析</h1>
        <!-- 🔗 功能導航區 -->
        <div style="margin-bottom: 1em;">
            <strong>功能選單：</strong>
            <a href="/">好友清單</a> |
            <a href="/history">變更紀錄</a> |
            <a href="/country">國別分析</a> |
            國別統計圖 |
            <a href="/trend">好友趨勢圖</a> |
            <a href="/status-board">好友狀態看板</a> |
            <a href="/filter">條件篩選</a> |
            <a href="/update">更新好友資料 (非必要)</a> |
        </div>
        <div>
            排序：
            {% if sort_mode == 'count' %}
                <b>人數</b> |
                <a href="/country?sort=name">國名</a>
            {% else %}
                <a href="/country?sort=count">人數</a> |
                <b>國名</b>
            {% endif %}
        </div>

        <ul class="country-list">
            {% for code, count in sorted_items %}
                <li>
                    <details>
                        <summary>
                            <strong>{{ code }}</strong>
							({{ country_name_map[code] if code in country_name_map else 'Unknown' }})：{{ count }} 人
                        </summary>
                        <ul class="friend-list">
                            {% for friend in country_members[code] %}
                                <li class="friend-item">
                                    <a href="{{ friend.profile_url }}" target="_blank" style="display: flex; text-decoration: none; color: inherit;">
                                        <img src="{{ friend.avatar if friend.avatar else '/static/default-avatar.png' }}" alt="avatar">
                                        <div class="friend-info">
                                            <strong>{{ friend.persona_name or '[未知名稱]' }}</strong><br>
                                            <small>加入於 {{ friend.friend_since | datetimeformat }}</small>
                                        </div>
                                    </a>
                                </li>
                            {% endfor %}
                        </ul>
                    </details>
                </li>
            {% endfor %}
        </ul>
    </div>
</body>
</html>
